wantType:
  metadata:
    name: flight_mock_server
    title: Flight Mock Server
    description: |
      Manages the lifecycle of the flight mock server process.

      This want type starts, monitors, and stops the flight mock server
      that provides mock flight booking and status APIs for testing and development.

      The server process is managed by a DoAgent that handles startup, monitoring,
      and graceful shutdown when the want is deleted.

      Useful for integration testing, demos, and development workflows that
      require a mock flight API backend.
    version: '1.0'
    category: system
    pattern: independent

  parameters:
  - name: server_binary
    description: Path to the flight server binary executable
    type: string
    default: ./bin/flight-server
    required: false
    example: ./bin/flight-server

  - name: log_file
    description: Path to the server log file
    type: string
    default: logs/flight-server.log
    required: false
    example: logs/flight-server.log

  state:
  - name: server_phase
    description: Current phase of the server lifecycle
    type: string
    persistent: true
    initialValue: starting
    example: running

  - name: server_binary
    description: Path to the server binary being used
    type: string
    persistent: true
    initialValue: ./bin/flight-server
    example: ./bin/flight-server

  - name: log_file
    description: Path to the active log file
    type: string
    persistent: true
    initialValue: logs/flight-server.log
    example: logs/flight-server.log

  - name: server_pid
    description: Process ID of the running server (0 if not running)
    type: int
    persistent: true
    initialValue: 0
    example: 12345

  - name: error_message
    description: Error message if server failed to start
    type: string
    persistent: true
    initialValue: ''
    example: 'Failed to bind to port 8081'

  connectivity:
    inputs: []
    outputs: []

  require:
    connectivity: none

  agents:
  - name: mock_server_management
    role: action
    description: DoAgent that starts and stops the flight mock server process
    example: Starts server on first execution, stops on want deletion

  constraints:
  - description: Server binary must exist and be executable
    validation: server_binary file must exist with execute permissions
  - description: Log file directory must be writable
    validation: log_file parent directory must have write permissions

  examples:
  - name: basic_mock_server
    description: Start flight mock server with default settings
    want:
      metadata:
        name: flight-mock-server
        type: flight_mock_server
      spec:
        params: {}

  - name: custom_log_mock_server
    description: Start flight mock server with custom log file
    want:
      metadata:
        name: flight-mock-server-dev
        type: flight_mock_server
      spec:
        params:
          log_file: logs/flight-server-dev.log

  relatedTypes:
  - execution_result
  - reminder

  seeAlso:
  - agent_flight_api
  - monitor_flight_api
