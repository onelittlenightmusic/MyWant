wantType:
  metadata:
    name: "collector"
    title: "Packet Collector"
    description: |
      Terminal sink that collects and aggregates all incoming packets from
      upstream processors. Implements packet collection with termination
      callbacks for final statistics and reporting.

      This is an alternative name for the sink want type, commonly used in
      queueing contexts to emphasize its data collection role.

    version: "1.0"
    category: "queue"
    pattern: "sink"

  parameters: []

  state:
    - name: "total_processed"
      description: "Total number of packets received and collected"
      type: "int"
      persistent: true
      example: 1000

    - name: "average_wait_time"
      description: "Average wait time for packets reaching collector"
      type: "float64"
      persistent: true
      example: 0.05

    - name: "total_wait_time"
      description: "Total accumulated wait time across all packets"
      type: "float64"
      persistent: true
      example: 50.0

    - name: "collection_started_at"
      description: "Timestamp when collection began"
      type: "string"
      persistent: true

    - name: "collection_ended_at"
      description: "Timestamp when collection completed"
      type: "string"
      persistent: true

  connectivity:
    inputs:
      - name: "packet_stream"
        type: "want"
        description: "Incoming packets to collect"
        required: true
        multiple: true

    outputs: []

  agents: []

  constraints:
    - description: "Must have at least one input"
      validation: "number_of_inputs >= 1"

    - description: "Collector terminates upon end signal"
      validation: "processes until end packet received"

  examples:
    - name: "Collect Queue Output"
      description: "Collect packets from a single queue processor"
      params: {}
      expectedBehavior: |
        1. Collector blocks waiting for packets
        2. Receives packets from upstream queue
        3. Increments counter for each packet
        4. Upon end signal, computes final statistics
        5. Reports total packets and timing metrics
      connectedTo: ["queue"]

    - name: "Collect from Multiple Combiners"
      description: "Collect from combined streams of multiple sources"
      params: {}
      expectedBehavior: |
        1. Collector receives from combiner output
        2. Combiner feeds packets from multiple queues
        3. Collector tracks all packets
        4. On termination, reports aggregate metrics
        5. Useful for throughput measurement
      connectedTo: ["combiner"]

    - name: "Collect Complex Pipeline Output"
      description: "Terminal collection from multi-stage pipeline"
      params: {}
      expectedBehavior: |
        1. Numbers generator feeds queue
        2. Queue feeds combiner
        3. Combiner feeds collector
        4. Collector accumulates all outputs
        5. Final report shows end-to-end throughput
      connectedTo: ["combiner"]

  relatedTypes:
    - "sink"
    - "combiner"
    - "queue"

  seeAlso:
    - "Queue system pipeline documentation"
    - "Sink vs Collector naming convention"
    - "Packet collection and statistics"
